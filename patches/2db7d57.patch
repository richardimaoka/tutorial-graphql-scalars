commit 2db7d57e40f931e5b0542aaa15f02761bad4b1c3
Author: Richard Imaoka <richard.e.imaoka@gmail.com>
Date:   Sat Aug 6 21:15:10 2022 +0900

    update steps 2

diff --git a/steps/1-setup-apollo-server-and-codegen.sh b/steps/1-setup-apollo-server-and-codegen.sh
index 160c902..cd52eeb 100755
--- a/steps/1-setup-apollo-server-and-codegen.sh
+++ b/steps/1-setup-apollo-server-and-codegen.sh
@@ -4,9 +4,9 @@
 
 # ä¸‹å›³ã®ã‚ˆã†ã« 3 ã¤ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ã„ã¾ã™ã€‚ã¾ãšã¯ 1 ã¤ç›®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç«‹ã¡ä¸Šã’ã¦ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‹ã‚‰ GraphQL Codegen ã®å®Ÿè¡Œã¾ã§ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚
 
-#![ã‚¢ãƒ¼ãƒˆãƒœãƒ¼ãƒ‰ 2.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/7e11f3d9-5947-276f-2860-52e8a96f154e.png)
+# ![ã‚¢ãƒ¼ãƒˆãƒœãƒ¼ãƒ‰ 2.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/7e11f3d9-5947-276f-2860-52e8a96f154e.png)
 
-#:large_orange_diamond: Action: ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä¸€æ°—ã«å…¨éƒ¨ã‚³ãƒ”ãƒ¼ & ãƒšãƒ¼ã‚¹ãƒˆã—ã¦å®Ÿè¡Œã—ã¦æ§‹ã„ã¾ã›ã‚“ã€‚
+# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä¸€æ°—ã«å…¨éƒ¨ã‚³ãƒ”ãƒ¼ & ãƒšãƒ¼ã‚¹ãƒˆã—ã¦å®Ÿè¡Œã—ã¦æ§‹ã„ã¾ã›ã‚“ã€‚
 
 # ```terminal
 mkdir server
diff --git a/steps/2-graphql-scalars.sh b/steps/2-graphql-scalars.sh
index 730e924..8d65b5a 100644
--- a/steps/2-graphql-scalars.sh
+++ b/steps/2-graphql-scalars.sh
@@ -11,7 +11,15 @@ cd server
 npm install graphql-scalars
 # ```
 
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/schema.gql` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
+# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
+
+# ```shell
+git apply patches/258a5ef.patch # update schema.gql
+git apply patches/4bf1886.patch # update index.ts
+git apply patches/6d40e7f.patch # update Query.json
+# ```
+
+# <details><summary>:white_check_mark: Result: ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã§æ›´æ–°ã•ã‚Œã‚‹ schema.gql</summary><div>
 
 # ```graphql:server/schema.gql
 # scalar EmailAddress
@@ -26,7 +34,12 @@ npm install graphql-scalars
 # }
 # ```
 
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/src/index.ts` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
+# ---
+
+# </div></details>
+
+# <details><summary>:white_check_mark: Result: ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã§æ›´æ–°ã•ã‚Œã‚‹ index.ts</summary><div>
+
 # ```ts:server/src/index.ts
 # import { ApolloServer, gql } from "apollo-server";
 # import * as fs from "fs";
@@ -82,14 +95,18 @@ npm install graphql-scalars
 #   },
 # });
 
-# // The  method launches a web server.
+# // The `listen` method launches a web server.
 # server.listen().then(({ url }) => {
-#   console.log();
+#   console.log(`ğŸš€  Server ready at ${url}`);
 # });
+
 # ```
 
+# ---
+
+# </div></details>
 
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/data/Query.json` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
+# <details><summary>:white_check_mark: Result: ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã§æ›´æ–°ã•ã‚Œã‚‹ Query.json</summary><div>
 
 # ```json:server/data/Query.json
 # {
@@ -100,78 +117,72 @@ npm install graphql-scalars
 # }
 # ```
 
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/src/index.ts` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
-#   override in index.ts, and return 10 -> error https://github.com/richardimaoka/tutorial-graphql-scalars/commit/5edea8ed55cf85d145edfc3c36746a74378aa148
-
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/config.yml` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
-#   config.yml to set string -> static type checking! https://github.com/richardimaoka/tutorial-graphql-scalars/commit/5edea8ed55cf85d145edfc3c36746a74378aa148
-# :white_check_mark: Result: Type CheckingãŒæ­£ã—ãåŠ¹ã„ã¦ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
-
-# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã¨ãŠã‚Š `server/src/index.ts` ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚
-#   however, returning a string with wrong-format passes static typing... https://github.com/richardimaoka/tutorial-graphql-scalars/commit/3396121dde6f3ced560498c3c07e84b7d1d0d03e
-# :white_check_mark: Result: stringã§ã‚ã‚‹ã¨ã„ã†ã ã‘ã§Type CheckingãŒæˆåŠŸã—ã¦ã—ã¾ã„ã€ä¸æ­£ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ã‚’æ¤œçŸ¥ã§ãã¾ã›ã‚“ã€‚
-
-
-# :large_orange_diamond: Action: Apollo Studio Explorer ã§ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
-#   querying from apollo studio givens a runtime error
-# :white_check_mark: Result: ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
-
-# ã“ã‚ŒãŒgraphql-scalarsã‚’ãã®ã¾ã¾ä½¿ã£ãŸéš›ã®é™ç•Œã§ã™ã€‚
-
-# EmailAddress - schema.gql, data/Query.json, Apollo Studio
-#   override in index.ts, and return 10 -> error https://github.com/richardimaoka/tutorial-graphql-scalars/commit/5edea8ed55cf85d145edfc3c36746a74378aa148
-#   config.yml to set string -> static type checking! https://github.com/richardimaoka/tutorial-graphql-scalars/commit/5edea8ed55cf85d145edfc3c36746a74378aa148
-        # ![2022-08-03_00h20_53.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/25250495-3c88-b8e3-20f5-c89dca067c1e.png)
-        # (property) emailAddress: Resolver<Maybe<ResolverTypeWrapper<string>>, Person, LoadingDataContext, {}>
-        # Type '(parent: Person, _args: {}, _context: LoadingDataContext, _info: GraphQLResolveInfo) => number' is not assignable to type 'Resolver<Maybe<ResolverTypeWrapper<string>>, Person, LoadingDataContext, {}>'.
-        #   Type '(parent: Person, _args: {}, _context: LoadingDataContext, _info: GraphQLResolveInfo) => number' is not assignable to type 'ResolverFn<Maybe<ResolverTypeWrapper<string>>, Person, LoadingDataContext, {}>'.
-        #     Type 'number' is not assignable to type 'Maybe<ResolverTypeWrapper<string>> | Promise<Maybe<ResolverTypeWrapper<string>>>'.ts(2322)
-        # graphql.ts(170, 3): The expected type comes from property 'emailAddress' which is declared here on type 'PersonResolvers<LoadingDataContext, Person>'
-#   however, returning a string with wrong-format passes static typing... https://github.com/richardimaoka/tutorial-graphql-scalars/commit/3396121dde6f3ced560498c3c07e84b7d1d0d03e
-#   querying from apollo studio givens a runtime error
-    #  ![2022-08-03_00h31_54.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/d5bb9f73-4e20-3c32-9eeb-41e5e4d6c055.png)
-    # {
-    #   "errors": [
-    #     {
-    #       "message": "Value is not a valid email address: someone@@@@@gmail.com",
-    #       "locations": [
-    #         {
-    #           "line": 3,
-    #           "column": 5
-    #         }
-    #       ],
-    #       "path": [
-    #         "me",
-    #         "emailAddress"
-    #       ],
-    #       "extensions": {
-    #         "code": "INTERNAL_SERVER_ERROR",
-    #         "exception": {
-    #           "stacktrace": [
-    #             "TypeError: Value is not a valid email address: someone@@@@@gmail.com",
-    #             "    at GraphQLScalarType.validate$1 (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql-scalars/index.js:917:15)",
-    #             "    at completeLeafValue (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:738:39)",
-    #             "    at completeValue (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:619:12)",
-    #             "    at executeField (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:489:19)",
-    #             "    at executeFields (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:413:20)",
-    #             "    at completeObjectValue (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:914:10)",
-    #             "    at completeValue (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:635:12)",
-    #             "    at executeField (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:489:19)",
-    #             "    at executeFields (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:413:20)",
-    #             "    at executeOperation (/home/richardimaoka/ghq/src/github.com/richardimaoka/tutorial-graphql-scalars/server/node_modules/graphql/execution/execute.js:344:14)"
-    #           ]
-    #         }
-    #       }
-    #     }
-    #   ],
-    #   "data": {
-    #     "me": {
-    #       "emailAddress": null,
-    #       "name": "Jason Summerwinter"
-    #     }
-    #   }
-    # }
+# ---
+
+# </div></details>
+
+# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
+
+# ```shell
+git apply patches/8008a13.patch # return 10 in EmailAddress
+# ```
+
+# <details><summary>:white_check_mark: Result: ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã§æ›´æ–°ã•ã‚Œã‚‹ index.ts</summary><div>
+
+# ```diff:server/src/index.ts
+# emailAddress(parent, _args, _context, _info) {
+# -  return parent.emailAddress;
+# +  return 10;
+# }
+# ```    
+
+# ---
+
+# </div></details>
+
+# ä¸Šè¨˜ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ `return 10` ã¨ã—ã¦numberå‹ã®å€¤ã‚’è¿”ã—ã¦ã„ã¾ã™ã€‚numberå‹ã§ã¯GraphQLã®EmailAddresså‹ã®å€¤ã‚’è¡¨ç¾ã§ããªã„ã®ã§ã€TypeScriptã®å‹ãƒã‚§ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¦ã»ã—ã„ã¨ã“ã‚ã§ã™ã€‚ãã“ã§ä»¥ä¸‹ã®å¤‰æ›´ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚
+
+# :large_orange_diamond: Action: ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
+
+# ```shell
+git apply patches/e60bb3a.patch # Update codegen.yml to set EmailAddress as string
+# ```
+
+# <details><summary>:white_check_mark: Result: ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã§æ›´æ–°ã•ã‚Œã‚‹ config.yml</summary><div>
+
+# ```diff:config.yml
+# generates:
+#   src/generated/graphql.ts:
+#     plugins:
+#       - "typescript"
+#       - "typescript-resolvers"
+#     config:
+#       avoidOptionals: true
+# +       scalars:
+# +         EmailAddress: string
+# ```    
+
+# ---
+
+# </div></details>
+
+# <details><summary>:white_check_mark: Result: config.ymlã®å¤‰æ›´ã«ä¼´ã£ã¦ã€generated/graphql.ts ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™ã€‚</summary><div>
+
+# ```diff:server/src/generated/graphql.ts
+# export type Scalars = {
+#   ID: string;
+#   String: string;
+#   Boolean: boolean;
+#   Int: number;
+#   Float: number;
+# -  EmailAddress: any;
+# +  EmailAddress: string;
+# };
+# ```    
+
+# ---
 
+# </div></details>
 
 run generate
 npm start
